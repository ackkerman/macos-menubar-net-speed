# WiFi Speed Menu Bar Monitor

## 概要

macOS メニューバーに常駐し、以下 3 種類のネットワーク可視化を提供する軽量ツール。

1. **実効通信速度（常時）**
2. **最大通信速度（オンデマンド）**
3. **top 形式の詳細通信状況（オンデマンド）**

本ツールは **通常時に一切の外部通信を行わない** ことを最優先設計思想とする。

---

## 設計思想

- 静かに常駐する
- ユーザーの明示操作以外では通信しない
- OS が持つ一次情報（カーネル統計）を信頼する
- 「今」と「最大値」と「詳細」を明確に分離する

---

## 機能一覧

### 1. 実効通信速度（常時）

- Wi-Fi インターフェース（en0）限定
- OS のネットワーク統計（getifaddrs）を使用
- 上り / 下りを分離表示
- 更新間隔：1 秒
- ネットワーク不可時：0 表示

表示例：
```

↓ 1.2MB ↑ 0.3MB

```

---

### 2. 最大通信速度測定（ボタン操作）

- ユーザーがメニューから明示的に実行
- 実行時のみ一時的に通信を行う
- 測定後は値を固定し、次回実行まで更新しない

測定方式：
- 下り：HTTP ダウンロード（時間固定）
- 上り：HTTP アップロード（時間固定）

表示例：
```

Max ↓ 320 ↑ 110 Mbps

```

---

### 3. top 形式ネットワーク表示（ボタン操作）

- macOS 標準の `nettop` コマンドを使用
- 新しい Terminal ウィンドウを開いて実行
- GUI 本体は通信に関与しない

実行コマンド例：
```

nettop -I en0 -s 1

```

---

## UI 構成

### メニューバー

- 通常時：実効通信速度表示
- 最大速度取得後：最大速度表示に切替

### メニュー内容

```

• Measure Max Speed
• Open Network Monitor (top)
──────────────
• Quit

```

---

## 非機能要件

- Dock に表示しない（LSUIElement）
- バッテリー消費最小化
- バックグラウンド通信なし
- VPN 接続時は VPN 経由通信を除外

---

## 対応範囲外

- 理論最大帯域の常時計測
- 自動バックグラウンド速度測定
- 常時パケットキャプチャ
